# ## –ß–∞—Å—Ç—å 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

*(—á—Ç–æ –∑–¥–µ—Å—å –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å, –∏ –∑–∞—á–µ–º)*

---

# # üî• A. Distributed Transactions: –æ—Ç 2PC –¥–æ Saga

## üß® –ë–æ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤–µ—Å—å —Ä–∞–∑–≥–æ–≤–æ—Ä

–ë–∏–∑–Ω–µ—Å –≥–æ–≤–æ—Ä–∏—Ç: ¬´–í–æ—Ç —Ç—É—Ç –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç 3 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞, –∏ —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –∞—Ç–æ–º–∞—Ä–Ω–æ¬ª.
–ò —Ç—ã —Å–∏–¥–∏—à—å, –≥—Ä—É—Å—Ç–Ω–æ —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ —ç—Ç–æ –¢–ó, –ø–æ–Ω–∏–º–∞—è:

* –Ω–µ—Ç –æ–¥–Ω–æ–π –±–∞–∑—ã
* –Ω–µ—Ç –æ–¥–Ω–æ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
* –Ω–µ—Ç shared lock manager
* –µ—Å—Ç—å –∫—É—á–∞ —Å–µ—Ä–≤–∏—Å–æ–≤, –∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–µ–π –ë–î
* —Å–µ—Ç—å –Ω–µ –Ω–∞–¥—ë–∂–Ω–∞
* –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∂–∏–≤—ë—Ç –≤ —Å–≤–æ—ë–º —Å–ª–æ–µ –∞–¥–∞

–ò –±–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ç–∞–∫–∏–µ:

* –¥–µ–Ω—å–≥–∏ —Å–ø–∏—Å–∞–ª–∏—Å—å, –∞ –∑–∞–∫–∞–∑ –Ω–µ —Å–æ–∑–¥–∞–ª—Å—è
* –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–ª—Å—è –¥–≤–∞–∂–¥—ã
* –æ–¥–Ω–æ –∏–∑ —Å–æ–±—ã—Ç–∏–π –ø–æ—Ç–µ—Ä—è–ª–æ—Å—å
* –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É

–ò –≤–æ—Ç –æ–Ω–æ ‚Äî **–Ω—É–∂–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ—Ç**.

---

## üéØ –ß—Ç–æ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –≤ —ç—Ç–æ–π —á–∞—Å—Ç–∏ (–≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤–æ)

### 1. –ü–æ—á–µ–º—É –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è ‚Äú–±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç‚Äù –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö

* –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ ACID
* —Å–µ—Ç—å –Ω–µ–Ω–∞–¥—ë–∂–Ω–∞
* –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–º–µ—Ä–µ—Ç—å
* —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π commit = –∫–æ—à–º–∞—Ä
* CAP –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç ‚Äú–∫–∞–∫ –≤ –º–æ–Ω–æ–ª–∏—Ç–µ‚Äù

### 2. 2PC (Two-Phase Commit)

*–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ—á–µ–º—É —ç—Ç–æ –±–æ–ª—å.*

* Coordinator ‚Üí prepare ‚Üí commit
* –µ—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —É–∑–ª–æ–≤ –∑–∞–≤–∏—Å–Ω–µ—Ç ‚Äî –≤—Å—è —Å–∏—Å—Ç–µ–º–∞ –≤–∏—Å–∏—Ç
* –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ–ª–≥–∏–µ
* –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –≤—Å–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
* single point of failure
* –ø–æ—á–µ–º—É –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–¥–∞—Ö 2PC –ø–æ—á—Ç–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç

–°–º—ã—Å–ª –±–ª–æ–∫–∞: **2PC ‚Äî —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –∫—Ä–∞—Å–∏–≤–æ, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–Ω–∞–¥—ë–∂–Ω–æ**.

### 3. Saga Pattern (–∫–∞—Å–∫–∞–¥ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)

*–í–æ—Ç —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–º–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞.*

* –∫–∞–∂–¥–∞—è ‚Äú—à–∞–≥-–æ–ø–µ—Ä–∞—Ü–∏—è‚Äù –∏–º–µ–µ—Ç ‚Äú–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é‚Äù
* –Ω–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
* –Ω–µ—Ç coordinator deadlock
* —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ workflow
* –ª–∏–±–æ –ø—Ä–æ—Ü–µ—Å—Å —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
* –ª–∏–±–æ –º—ã –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º—Å—è –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏

–†–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ–º:

* orchestration vs choreography
* –∫–∞–∫ –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–∞–≥–∞ workflow
* –≥–¥–µ —Å–∞–≥–∏ –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å (–Ω–∏–∫–∞–∫–æ–≥–æ –≤–æ–ª—à–µ–±—Å—Ç–≤–∞)
* Temporal, Camunda, Conductor: –∑–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã
* –∫–∞–∫ –∂–∏—Ç—å —Å eventual consistency –≤–Ω—É—Ç—Ä–∏ —Å–∞–≥–∏

### 4. –ë–æ–ª–∏ —Å–∞–≥

* ‚Äú–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è‚Äù –Ω–µ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω–∞
* –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–µ–ª—å–∑—è —Å—Ç–µ—Ä–µ—Ç—å
* –≤–Ω–µ—à–Ω–∏–µ API –Ω–µ–ª—å–∑—è –æ—Ç–∫–∞—Ç–∏—Ç—å
* —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
* —Å–ª–æ–∂–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å
* —Ç—Ä–µ–±—É–µ—Ç—Å—è idempotency

---

# # üî• B. Eventual Consistency

*(—Å–∞–º–∞—è —á–µ—Å—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞ –∂–∏–∑–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º)*

## üß® –ë–æ–ª—å

–¢—ã –¥–µ–ª–∞–µ—à—å –∑–∞–ø—Ä–æ—Å, –∞ –¥–∞–Ω–Ω—ã–µ ‚Äú–µ—â—ë –Ω–µ –¥–æ–µ—Ö–∞–ª–∏‚Äù.
–ö—ç—à –æ—Ç—Å—Ç–∞—ë—Ç.
–†–µ–ø–ª–∏–∫–∞ –æ—Ç—Å—Ç–∞—ë—Ç.
–°–æ–±—ã—Ç–∏–µ —É–ª–µ—Ç–µ–ª–æ ‚Äî –Ω–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –µ—â—ë –Ω–µ –≤–∏–¥–µ–ª.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–∏–ª –∏ —Å—Ä–∞–∑—É —Ö–æ—á–µ—Ç –≤–∏–¥–µ—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ.

–†–µ–∑—É–ª—å—Ç–∞—Ç:

* ‚Äú–ø–æ—á–µ–º—É —É –º–µ–Ω—è –∞–¥—Ä–µ—Å —Å—Ç–∞—Ä—ã–π?‚Äù
* ‚Äú–ø–æ—á–µ–º—É –±–∞–ª–∞–Ω—Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?‚Äù
* ‚Äú–ø–æ—á–µ–º—É –Ω–µ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å?‚Äù

–ü–æ—Ç–æ–º—É —á—Ç–æ ‚Äú—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å‚Äù = –∑–∞–¥–µ—Ä–∂–∫–∏, –æ—á–µ—Ä–µ–¥–∏, –∫—ç—à–∏, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è.

---

## üéØ –ß—Ç–æ –∑–¥–µ—Å—å –Ω—É–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã—Ç—å

### 1. –ú–æ–¥–µ–ª—å eventual consistency

* —á—Ç–æ –∑–Ω–∞—á–∏—Ç ‚Äú–≤ –∏—Ç–æ–≥–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ‚Äù
* –∫–∞–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–æ–ø—É—Å—Ç–∏–º—ã
* –≥–¥–µ eventual –æ–∫ (–Ω–æ–≤–æ—Å—Ç–Ω–∞—è –ª–µ–Ω—Ç–∞)
* –≥–¥–µ eventual –æ–ø–∞—Å–µ–Ω (–±–∞–ª–∞–Ω—Å, –ª–∏–º–∏—Ç—ã)

### 2. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏

* –∫—ç—à
* —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
* –±—Ä–æ–∫–µ—Ä—ã –æ—á–µ—Ä–µ–¥–µ–π
* –∏–Ω–¥–µ–∫—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (Elasticsearch)
* background jobs
* –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏

### 3. –ú–µ—Ç—Ä–∏–∫–∏: ‚Äústaleness budget‚Äù

* —Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –¥–æ–ø—É—Å—Ç–∏–º–æ
* –∫–∞–∫ –∏–∑–º–µ—Ä—è—Ç—å stale-read-rate
* –∫–∞–∫ –∑–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å SLA

### 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—Å–∏–ª–∏–≤–∞—é—Ç eventual consistency

* CQRS
* event sourcing
* read models
* async projection
* snapshotting

### 5. –ö–∞–∫ –∂–∏—Ç—å —Å eventual consistency

* retry + idempotency
* optimistic UI
* write fences
* versioning (–ø—É—Å—Ç—å —ç—Ç–æ –∑–≤—É—á–∏—Ç –∑–Ω–∞–∫–æ–º–æ –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∞ cache coherence)

---

# # üî• C. Strong Consistency –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

*(—Å–∞–º–∞—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —á–∞—Å—Ç—å, –≥–¥–µ –ª—é–¥–∏ –æ–±—ã—á–Ω–æ –æ—Ñ–∏–≥–µ–≤–∞—é—Ç)*

## üß® –ë–æ–ª—å

–•–æ—á–µ—Ç—Å—è strong consistency, –Ω–æ:

* –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ—Ä–æ–≥–∏–µ
* global locks —É–±–∏–≤–∞—é—Ç throughput
* —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã
* 2PC –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
* optimistic locks –ª–æ–º–∞—é—Ç—Å—è –ø—Ä–∏ high contention

–ò –≤–æ—Ç –∑–∞–¥–∞—á–∞:
**–∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å strong consistency, –Ω–æ –Ω–µ —Ç–æ—Ä–º–æ–∑–∏—Ç—å –≤—Å—ë?**

---

## üéØ –ß—Ç–æ –∑–¥–µ—Å—å —Ä–∞—Å–∫—Ä—ã—Ç—å

### 1. ‚ÄúStrong enough‚Äù consistency

–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ full-serializable.
–ò–Ω–æ–≥–¥–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ **per-key strong consistency**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

* –æ–¥–∏–Ω —Å—á—ë—Ç—á–∏–∫ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
* –æ–¥–∏–Ω –∑–∞–∫–∞–∑ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–≤–∞–∂–¥—ã
* –æ–¥–Ω–∞ –∫–æ—Ä–∑–∏–Ω–∞ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –≥–æ–Ω–∫–∞–º–∏
* –æ–¥–∏–Ω –±–∞–ª–∞–Ω—Å –Ω–µ —É—Ö–æ–¥–∏—Ç –≤ –º–∏–Ω—É—Å

### 2. –¢–µ—Ö–Ω–∏–∫–∏ strong consistency –±–µ–∑ –±–æ–ª—å—à–∏—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

* –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (versioning / CAS)
* monotonic writes
* single-writer per key
* sequencer (–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)
* write fences
* lease-based control
* logical timestamps
* conditional writes (compare-and-set everywhere)

### 3. –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è: —Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ ‚Äú–º–∏–∫—Ä–æ-—Ä–µ–≥–∏–æ–Ω–æ–≤ –¥–∞–Ω–Ω—ã—Ö‚Äù

–ù–∞–ø—Ä–∏–º–µ—Ä:

* –∫–ª—é—á –≤ Redis –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞—Ç–æ–º–∞—Ä–Ω–æ
* —Ç–∞–±–ª–∏—Ü–∞ –≤ Postgres –ø–æ–¥–Ω–∏–º–∞–µ—Ç –≤–µ—Ä—Å–∏—é
* –ø–æ—Ç–æ–∫ Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞
* sharded counters

–¢–æ –µ—Å—Ç—å –Ω–µ –≤–µ—Å—å —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ‚Äú—Å—Ç—Ä–æ–≥–∏–º‚Äù, –∞ —Ç–æ–ª—å–∫–æ **—Ç–æ—á–∫–∏, –≥–¥–µ –¥–µ–Ω—å–≥–∏ —É—Ö–æ–¥—è—Ç –≤–ª–µ–≤–æ-–≤–ø—Ä–∞–≤–æ**.

### 4. –ö–æ–≥–¥–∞ strong consistency –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞

–ü—Ä—è–º–æ –∏ —á–µ—Å—Ç–Ω–æ:

* –Ω–µ—Å–∫–æ–ª—å–∫–æ write-—É–∑–ª–æ–≤
* –∫—Ä–æ—Å—Å-—Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏
* –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
* –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å
* –º–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–æ–≤, –ø–∏—à—É—â–∏—Ö –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ
* —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚Äú—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –æ—Ç –¥—É—Ä–∞–∫–∞ + 0 —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏‚Äù

–¢—É—Ç –Ω–∞–¥–æ –≤—ã–±—Ä–∞—Ç—å ‚Äî –ª–∏–±–æ Paxos/Raft (–¥–æ—Ä–æ–≥–æ), –ª–∏–±–æ –∂–∏—Ç—å —Å eventual.

