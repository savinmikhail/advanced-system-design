## Блок 4.2. Многоуровневое кэширование и оптимизации

### Архитектура слоёв

Касательно latency - мы хотим отдавать данные как можно ближе к пользователю. Зачем тянуть картинку из S3 в БД, если её может отдать CDN за 10ms?
Зачем каждый раз ходить в Redis (2-5ms), если можно держать маленький L1-кэш прямо в памяти сервера (<1ms)?
Вдобавок ем раньше мы отдадим что-то из кеша, тем меньше мы нагрузим дальнейшие слои системы

Но чем больше слоёв, тем сложнее поддерживать согласованность.

Вопрос: **какие данные на каком уровне держать?**

![Многоуровневый кэш по слоям](assets/01-cache-layers-levels.png)

Важны метрики hit rate, latency по слоям, подробнее о мониторинге поговорим в конце
