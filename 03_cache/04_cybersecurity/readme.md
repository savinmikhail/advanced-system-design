## –ë–ª–æ–∫ 4.5. –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ –∫–µ—à–µ

### cache poisoning

**Cache poisoning** ‚Äî —ç—Ç–æ —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –≤ –∫—ç—à –ø–æ–ø–∞–¥–∞–µ—Ç **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –∏–ª–∏ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**, –∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å —ç—Ç–æ ‚Äú–æ—Ç—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ‚Äù —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ–º, –∫—Ç–æ –∫ –Ω–µ–º—É –æ–±—Ä–∞—â–∞–µ—Ç—Å—è.

–ü—Ä–æ–±–ª–µ–º–∞ –∫–æ–≤–∞—Ä–Ω–∞—è:
–∏–Ω–æ–≥–¥–∞ —ç—Ç–æ –∏–∑-–∑–∞ –Ω–∞—à–∏—Ö –±–∞–≥–æ–≤, –∞ –∏–Ω–æ–≥–¥–∞ ‚Äî –ø—Ä—è–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∞—Ç–∞–∫–∞.

–ù–∏–∂–µ —Ä–∞–∑–¥–µ–ª—è—é —á—ë—Ç–∫–æ –¥–≤–∞ –º–∏—Ä–∞.

---

#### üß± 1. Application Cache Poisoning (–Ω–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–∞–≥–∏)

–≠—Ç–æ 90% —Å–ª—É—á–∞–µ–≤ –≤ –æ–±—ã—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö.

–ü—Ä–∏—á–∏–Ω—ã:

##### ‚úî –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á

–¢—ã –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–ª `/product?id=123`,
–∞ –∑–∞–±—ã–ª, —á—Ç–æ —É –∑–∞–ø—Ä–æ—Å–∞ –±—ã–ª query `?currency=usd`.
–í –∏—Ç–æ–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–≤–æ–µ–π –≤–∞–ª—é—Ç—ã.

##### ‚úî –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ TTL

–ö–ª—é—á –∂–∏–≤—ë—Ç –º–µ—Å—è—Ü–∞–º–∏. –î–∞–Ω–Ω—ã–µ –¥–∞–≤–Ω–æ –ø–æ–º–µ–Ω—è–ª–∏—Å—å, –∞ –∫—ç—à –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –≤—Å–µ–ª–µ–Ω–Ω–æ–π.

##### ‚úî –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

–í–µ—Ä—Å–∏—è v1 –ø–∏—à–µ—Ç –æ–¥–∏–Ω JSON,
–≤–µ—Ä—Å–∏—è v2 ‚Äî –¥—Ä—É–≥–æ–π.
–ü–æ–ª–æ–≤–∏–Ω–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–µ —É–º–µ–µ—Ç —á–∏—Ç–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç ‚Üí –≤—Å—ë –ª–æ–º–∞–µ—Ç—Å—è.

##### ‚úî –°–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏ (race condition)

–ü–æ–∑–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π –∫—ç—à —Å—Ç–∞—Ä—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.

##### ‚úî Write-behind / eventual-write –≥–ª—é–∫–∏

–î–∞–Ω–Ω—ã–µ –≤ Redis –æ–±–Ω–æ–≤–∏–ª–∏—Å—å, –∞ –∑–∞–ø–∏—Å—å –≤ –ë–î –Ω–µ –ø—Ä–æ—à–ª–∞.

##### ‚úî –ù–µ—É—á—Ç—ë–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

–ù–∞–ø—Ä–∏–º–µ—Ä:
—Ä–∞–∑–Ω—ã–µ —Ä–æ–ª–∏, —Ä–∞–∑–Ω—ã–µ —Ñ–ª–∞–≥–∏, –Ω–æ –∫–ª—é—á –ø–æ—Å—Ç—Ä–æ–µ–Ω –æ–¥–∏–Ω–∞–∫–æ–≤–æ.

##### ‚úî –ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ –∫–ª–∞–¥—ë—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

–ö—Ä–∏–≤–æ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø—Ä–æ–º–∞—Ö–Ω—É–ª—Å—è –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É ‚Äî –ø–æ–ª—É—á–∏–ª —Å—Ç–∞—Ä—ã–π snapshot –∏ —Ä–∞–∑–º–∞–∑–∞–ª –ø–æ –≤—Å–µ–º—É –∫—ç—à—É.

–≠—Ç–∞ —Ñ–æ—Ä–º–∞ poisoning –Ω–µ –ø—Ä–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.
–≠—Ç–æ –ø—Ä–æ —Ç–æ, —á—Ç–æ **–º—ã —Å–∞–º–∏ –∑–∞—Å—Ä–∞–ª–∏ –∫—ç—à**, –∏ —Ç–µ–ø–µ—Ä—å –æ–Ω –≥–∞–¥–∏—Ç –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

---

#### üß® 2. Web Cache Poisoning (–∞—Ç–∞–∫–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞)

–≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. –ü—Ä—è–º –Ω–∞—Å—Ç–æ—è—â–∞—è.

–°—Ü–µ–Ω–∞—Ä–∏–π —Ç–∞–∫–æ–π:

1. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —à–ª—ë—Ç –∑–∞–ø—Ä–æ—Å —Å —Ö–∏—Ç—Ä—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
2. CDN / Reverse Proxy / Varnish / Nginx –∫–ª–∞–¥—ë—Ç **—ç—Ç–æ—Ç –∂–µ –æ—Ç–≤–µ—Ç** –≤ —Å–≤–æ–π –∫—ç—à
3. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç **–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç**

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã:

##### ‚úî XSS —á–µ—Ä–µ–∑ –∫—ç—à

–•–∞–∫–µ—Ä –ø–æ–¥—Å–æ–≤—ã–≤–∞–µ—Ç HTML/JS, CDN –µ–≥–æ –∫—ç—à–∏—Ä—É–µ—Ç, –∏ –¥–∞–ª—å—à–µ –±—Ä–∞—É–∑–µ—Ä—ã –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ–≥–æ –∏—Å–ø–æ–ª–Ω—è—é—Ç.

##### ‚úî –ü–æ–¥–º–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü

–ù–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–¥–∞—ë–º –Ω–µ —Ç–æ—Ç HTML –Ω–∞ –≥–ª–∞–≤–Ω–æ–π.

##### ‚úî Bypass –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –∫—ç—à–∏—Ä–æ–≤–∞–ª –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –∫–∞–∫ –ø—É–±–ª–∏—á–Ω—ã–π.

##### ‚úî –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

`X-Forwarded-Host`, `X-Original-URL`, `Accept-Encoding`, `Vary`, `Host` ‚Äî
–≤—Å—ë —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞—Ç–∞–∫–µ, —á—Ç–æ–±—ã —Å–∫–æ—Ä–º–∏—Ç—å –ø—Ä–æ–∫—Å–∏ ‚Äú—É–Ω–∏–∫–∞–ª—å–Ω—ã–π‚Äù –æ—Ç–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ø–∞–¥—ë—Ç –≤ –∫—ç—à.

##### ‚úî –û—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ï—Å–ª–∏ –∫–ª—é—á –∫—ç—à–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –¥–æ–±–∏—Ç—å—Å—è —á—É–∂–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

–≠—Ç–æ —Ç–æ, —á—Ç–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç PortSwigger, OWASP –∏ –≤—Å–µ –±–∞–≥-–±–∞—É–Ω—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

___

### üé≠ Cache Deception


–ï—Å–ª–∏ **Web Cache Poisoning** ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ö–∞–∫–µ—Ä *–∫–ª–∞–¥—ë—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –∫—ç—à*,
—Ç–æ **Cache Deception** ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ö–∞–∫–µ—Ä *–∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ–∫—Å–∏/ CDN –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–¥ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º URL*.

–°–º—ã—Å–ª:
–∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç **–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á—É–∂–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**,
–ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –æ—à–∏–±–æ—á–Ω–æ –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ.

–≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∞ –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

---

#### üî• –ö–∞–∫ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç (–∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å:

1. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:

   ```
   /account
   ```

   –û–Ω–∞ **–Ω–µ–ª—å–∑—è –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å** –∏ –≤—Å–µ–≥–¥–∞ –∑–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π.

2. –£ CDN –≤–∫–ª—é—á—ë–Ω –ø—Ä–∞–≤–∏–ª–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äú–≤—Å—ë, —É —á–µ–≥–æ –µ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ ‚Äî –æ—Ç–¥–∞—ë–º –∫–∞–∫ —Å—Ç–∞—Ç–∏–∫—É‚Äù
   –Ω–∞–ø—Ä–∏–º–µ—Ä:

   ```
   /anything.js ‚Üí cache
   /anything.css ‚Üí cache
   /anything.jpg ‚Üí cache
   ```

3. –•–∞–∫–µ—Ä –¥–µ–ª–∞–µ—Ç —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å:

   ```
   GET /account/../account.php.css
   ```

4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (backend) ‚Äú–Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç‚Äù –ø—É—Ç—å –∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–¥–∞—ë—Ç **–∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã /account**.

5. –ê CDN –≤–∏–¥–∏—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ **.css** ‚Üí –∏ –∫–ª–∞–¥—ë—Ç –æ—Ç–≤–µ—Ç –≤ –ø—É–±–ª–∏—á–Ω—ã–π –∫–µ—à.

6. –¢–µ–ø–µ—Ä—å –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –¥–µ–ª–∞–µ—Ç:

   ```
   GET /account/../account.php.css
   ```

   –∏ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –∂–µ—Ä—Ç–≤—ã.

–≠—Ç–æ –∏ –µ—Å—Ç—å **Cache Deception**:
–º—ã –ø–æ–¥—Å—É–Ω—É–ª–∏ CDN ‚Äú—á—É–∂–æ–π –ª–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç‚Äù –ø–æ–¥ –≤–∏–¥–æ–º *—Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞*.

---

#### ‚ùó –ü–æ—á–µ–º—É —ç—Ç–æ —Ç–∞–∫ –æ–ø–∞—Å–Ω–æ?

* —Ç—ã –æ–±—Ö–æ–¥–∏—à—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
* —Ç—ã –æ–±—Ö–æ–¥–∏—à—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
* CDN –∫—ç—à–∏—Ä—É–µ—Ç ‚Äú—á—É–∂–∏–µ‚Äù —Å—Ç—Ä–∞–Ω–∏—Ü—ã
* –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –º–∞—Å—Å–æ–≤–æ –≤—ã–∫–∞—á–∏–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏

–¢–æ –µ—Å—Ç—å —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ ‚Äú—Å–ª–æ–º–∞–ª—Å—è UI‚Äù ‚Äî —ç—Ç–æ **—É—Ç–µ—á–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**.

---

#### üß© –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

##### ‚úî –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è URL –≤ backend

Backend –¥—É–º–∞–µ—Ç, —á—Ç–æ `/user/123/../123` = `/user/123`.

##### ‚úî –ù–µ–≤–µ—Ä–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ CDN

‚Äú–ö—ç—à–∏—Ä—É–µ–º –≤—Å—ë —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏‚Äù.

##### ‚úî –ü—Ä–æ–±—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ù–∞–ø—Ä–∏–º–µ—Ä:

```
/profile?format=json.css
```

Backend –æ—Ç–¥–∞—ë—Ç JSON, CDN –¥—É–º–∞–µ—Ç ‚Äú—ç—Ç–æ .css ‚Üí –≤ –∫—ç—à‚Äù.

##### ‚úî –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Vary

–ï—Å–ª–∏ –Ω–µ—Ç `Vary: Cookie`, CDN —Å—á–∏—Ç–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–º.

---

#### üõ° –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è (–∫–æ—Ä–æ—Ç–∫–æ –∏ –ø–æ —Å—É—â–µ—Å—Ç–≤—É)

1. **–ó–∞–ø—Ä–µ—â–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü**

   ```
   Cache-Control: private, no-store
   ```

2. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å Cookie/Auth headers**

3. **–ù–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º URL**
   –∞ —Ç–æ–ª—å–∫–æ –ø–æ MIME-—Ç–∏–ø—É, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—É–ª backend.

4. **–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å URL –¥–æ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ CDN**
   —á—Ç–æ–±—ã CDN –≤–∏–¥–µ–ª —Ç–æ—Ç –∂–µ –ø—É—Ç—å, —á—Ç–æ –∏ backend.

5. **–í–∫–ª—é—á–∞—Ç—å Vary: Authorization / Cookie**, –≥–¥–µ —ç—Ç–æ –Ω—É–∂–Ω–æ.

6. **–ó–∞–ø—Ä–µ—Ç–∏—Ç—å path traversal** (`../`, `./`, `%2E%2E/`).
